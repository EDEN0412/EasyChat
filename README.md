## アプリケーション名

EasyChat

## アプリケーション概要
EasyChatは、シンプルで使いやすいチャットアプリケーションです。複雑な機能を省き、必要最小限の機能に特化することで、誰でも直感的に使えるコミュニケーションツールを目指しています。

## 利用方法
1. アカウント作成
   - ユーザー名とパスワードで簡単に登録
   - メールアドレスは不要

2. チャンネルの利用
   - 既存のチャンネルに参加
   - 新しいチャンネルの作成
   - チャンネル一覧から簡単に選択

3. メッセージの送信
   - テキストメッセージの送信
   - 絵文字リアクションの追加（👍👎❤️）
   - @マークでメンション

4. メッセージの管理
   - 自分のメッセージの編集
   - 自分のメッセージの削除
   - 過去のメッセージの閲覧

5. 基本的な通知
   - メンション時の通知
   - チャンネルでの新規メッセージ通知
   - ユーザーの入退室通知

## アプリケーションを作成した背景
近年、リモートワークやオンラインコミュニケーションの需要が高まっていますが、既存のチャットツールには以下のような課題があります：

1. 機能が多すぎて操作が複雑
2. 高齢者や IT に不慣れな方には使いづらい
3. 必要のない機能が多く、システムが重い
4. 初期設定や運用が複雑

これらの課題を解決するため、以下のようなユーザーに焦点を当てたアプリケーションを開発しました：

- IT初心者の方々
- シンプルな機能のみを求めるユーザー
- 小規模チームやコミュニティ
- 高齢者や技術に不慣れな方々

## 要件定義

### 1. ユーザー管理機能
- ユーザー登録（サインアップ）
  - ユーザー名とパスワードによる登録
  - パスワード確認機能
  - 重複ユーザー名のチェック
- ログイン/ログアウト
  - セッション管理による認証
  - ログイン状態の維持
- 基本的なパスワードセキュリティ
  - bcryptによる簡易的なハッシュ化

### 2. チャット機能
- メッセージ送信
  - テキストメッセージの送信
  - リアルタイムな表示更新
- 基本的なメッセージ管理
  - 編集機能（自分のメッセージのみ）
  - 削除機能（自分のメッセージのみ）
  - 編集済みフラグの表示
- チャンネル機能
  - チャンネルの作成
  - チャンネル一覧表示
- シンプルなメンション機能
  - ユーザーへのメンション（@ユーザー名）
- 基本的なリアクション機能
  - 定型絵文字のみ（👍👎❤️）
  - リアクションの追加/削除

### 3. システム通知
- ユーザーの入退室通知
- エラーメッセージの表示
  - 権限エラー
  - 操作失敗時の通知
- 基本的な通知
  - メンション通知のみ

### 4. データ永続化
- ユーザー情報の保存
  - MySQLデータベースによるデータ保存
  - ユーザープロフィール情報の管理
- チャット履歴の保存
  - メッセージデータの永続化
  - チャンネルごとのメッセージ管理
  - リアクション情報の保存

### 5. UI/UX要件
- シンプルなレスポンシブデザイン
- メッセージ編集用の基本的なモーダル
- スクロール可能なメッセージ領域

## データベース設計	
[![Image from Gyazo](https://i.gyazo.com/86bda46e3f3ebcdb93eaaa7f749c3387.png)](https://gyazo.com/86bda46e3f3ebcdb93eaaa7f749c3387)

## 画面遷移図	
[![Image from Gyazo](https://i.gyazo.com/f8e5911b68a181ffb12a7eaada8fbe5b.png)](https://gyazo.com/f8e5911b68a181ffb12a7eaada8fbe5b)

## 開発環境
- バックエンド
  - Flask（Webアプリケーションフレームワーク）
  - python-socketio（リアルタイムチャット用WebSocket通信）
  - SQLAlchemy（MySQLとの連携用ORMツール）
- フロントエンド
  - HTML/CSS
  - JavaScript（クライアントサイド）
  - Jinja2テンプレートエンジン
- データストア
  - MySQL 8.0
    - ユーザー情報、チャンネル、メッセージの管理
    - リアクションやメンション情報の保存
    - 効率的なデータ検索とリレーション管理
- 開発ツール
  - MySQL Sequel Ace（データベース管理ツール）
    - データベースの構造管理
    - クエリのテストと実行
    - データの可視化と編集

## ローカルでの動作方法

以下の手順で、ローカル環境でアプリケーションを実行できます。

### 前提条件
- Python 3.8以上
- MySQL 8.0以上
- Git

### 1. リポジトリのクローン
```bash
git clone https://github.com/your-username/easychat.git
cd easychat
```

### 2. データベースのセットアップ
```bash
# MySQLサーバーの起動確認
mysql.server start

# データベースとユーザーの作成
mysql -u root -p
CREATE DATABASE chatapp;
CREATE USER 'chatapp_user'@'localhost' IDENTIFIED BY 'your_password';
GRANT ALL PRIVILEGES ON chatapp.* TO 'chatapp_user'@'localhost';
FLUSH PRIVILEGES;
```

### 3. 環境変数の設定
```bash
# .envファイルの作成
cp .env.sample .env

# .envファイルを編集し、以下の項目を設定
# - データベース接続情報
# - アプリケーションポート
# - セッションシークレット
```

### 4. 依存パッケージのインストール
```bash
pip install -r requirements.txt
```

### 5. データベースのマイグレーション
```bash
flask db upgrade
```

### 6. アプリケーションの起動
```bash
python app.py
```

### 7. アプリケーションへのアクセス
ブラウザで以下のURLにアクセス：
```
http://localhost:5000
```

### 動作確認
1. ユーザー登録
   - トップページの「新規登録」をクリック
   - ユーザー名とパスワードを入力して登録

2. ログイン
   - 登録したユーザー名とパスワードでログイン

3. チャンネル作成
   - サイドバーの「+」ボタンでチャンネルを作成

4. メッセージの送信
   - チャンネルを選択
   - メッセージを入力して送信

### トラブルシューティング
1. データベース接続エラー
   - MySQLサービスが起動しているか確認
   - .envファイルの接続情報が正しいか確認

2. 依存パッケージのエラー
   - Pythonの仮想環境を再作成
   - requirements.txtの再インストール

3. ポート競合
   - 使用ポート（デフォルト:5000）が空いているか確認
   - .envファイルで別のポートに変更

## テスト環境のセットアップ

アプリケーションのテストを実行するには、以下の手順に従ってください。

### 1. テスト用データベースの作成
```bash
# MySQLでテスト用データベースを作成
mysql -u root -p
CREATE DATABASE test_chatapp;
GRANT ALL PRIVILEGES ON test_chatapp.* TO 'chatapp_user'@'localhost';
FLUSH PRIVILEGES;
```

### 2. テスト用環境変数の設定
```bash
# .env.testファイルの作成
cp .env.test.sample .env.test

# 必要に応じて設定を編集
# 特にデータベース接続情報を確認
```

### 3. テスト用テーブルの作成
```bash
# テスト用データベースにテーブルを作成
python create_test_db.py
```

### 4. テストの実行
```bash
# 全てのユニットテストを実行
FLASK_ENV=testing PYTHONPATH=$PYTHONPATH:. pytest tests/unit/ -v

# 特定のテストファイルのみ実行
FLASK_ENV=testing PYTHONPATH=$PYTHONPATH:. pytest tests/unit/test_auth.py -v

# 特定のテスト関数のみ実行
FLASK_ENV=testing PYTHONPATH=$PYTHONPATH:. pytest tests/unit/test_auth.py::test_user_registration -v
```

### 注意事項
- テストはテスト用データベース（test_chatapp）に対して実行されます
- テスト実行時は`FLASK_ENV=testing`環境変数を設定してください
- テスト実行後はテストデータベースの内容がリセットされます


